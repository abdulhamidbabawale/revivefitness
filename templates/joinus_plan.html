{% extends "base.html" %}
{% block content %}
{% load static %}

  <link rel="stylesheet" href="{% static 'join_plan.css'%}">

  <script
  src="https://code.jquery.com/jquery-3.7.0.js"
  integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM="
  crossorigin="anonymous"></script>
  {% block nav %}

  {% endblock %}



<div class="top_header">
  <h3>Select {{selected_plan}} plan duration</h3>

  <a id="change_plan" href="#">change plan <i class="fa-solid fa-chevron-down" id="arrowIcon"></i></a>
  <div class="select_plan">
    <label for="platinum_plan">
      <input onclick="window.location.reload()" id="platinum_plan" type="radio" name="plan" value="{{platinum_plan.id}}">
      <div class="plan_drop_down enlarge_on_hover">{{platinum_plan.plan_name}}</div>
    </label>
    <label for="standard_plan">
      <input onclick="window.location.reload()" id="standard_plan" type="radio" name="plan" value="{{standard_plan.id}}">
      <div class="plan_drop_down enlarge_on_hover">{{standard_plan.plan_name}}</div>
    </label>
  </div>
</div>
<div class="contents">

  <!-- <p id="selectedplanDisplay">Not selected</p> -->




  <div class="plans_duration">
    {% if selected_plan == 'platinum' %}
    <div class="duration monthly">
     <h4>Monthly <br>plan</h4>
     <p>Monthly <br> subscription</p>
     <p>₦{{duration_cost.platinum_monthly}}</p>
     <label for="monthly_plan">
       <input id="monthly_plan" type="radio" name="duration" value="monthly">
       <span type="button" id="select_but" class="enlarge_on_hover">select</span>
      </label>
     <p id="all_perks">Conatains all <a href="">perks</a> of {{platinum_plan.plan_name}} membership</p>
    </div>
    <div class="duration quaterly">
     <h4>Quaterly <br>plan</h4>
     <p>Quaterly <br> subscription</p>
     <p>₦{{duration_cost.platinum_quterly}}</p>
     <label for="quaterly_plan">
       <input id="quaterly_plan" type="radio" name="duration" value="quarterly">
       <span type="button" id="select_but" class="enlarge_on_hover">select</span>
      </label>
     <p id="all_perks">Conatains all <a href="">perks</a> of {{platinum_plan.plan_name}} membership</p>
    </div>

    <div class="duration yearly">
     <h4>Yearly <br>plan</h4>
     <p>Yearly <br> subscription</p>
     <p>₦{{duration_cost.platinum_yearly}}</p>
     <label for="yearly_plan">
       <input id="yearly_plan" type="radio" name="duration" value="yearly">
       <span type="button" id="select_but" class="enlarge_on_hover">select</span>
      </label>
     <p id="all_perks">Conatains all <a href="">perks</a> of {{platinum_plan.plan_name}} membership</p>
    </div>
    {% else %}
    <div class="duration monthly">
      <h4>Monthly <br>plan</h4>
      <p>Monthly <br> subscription</p>
      <p>₦{{duration_cost.standard_monthly}}</p>
      <label for="monthly_plan">
        <input id="monthly_plan" type="radio" name="duration" value="monthly">
        <span type="button" id="select_but" class="enlarge_on_hover">select</span>
       </label>
      <p id="all_perks">Conatains all <a href="">perks</a> of {{standard_plan.plan_name}} membership</p>
     </div>
     <div class="duration quaterly">
      <h4>Quaterly <br>plan</h4>
      <p>Quaterly <br> subscription</p>
      <p>₦{{duration_cost.standard_quterly}} </p>
      <label for="quaterly_plan">
        <input id="quaterly_plan" type="radio" name="duration" value="quarterly">
        <span type="button" id="select_but" class="enlarge_on_hover">select</span>
       </label>
      <p id="all_perks">Conatains all <a href="">perks</a> of {{standard_plan.plan_name}} membership</p>
     </div>

     <div class="duration yearly">
      <h4>Yearly <br>plan</h4>
      <p>Yearly <br> subscription</p>
      <p>₦{{duration_cost.standard_yearly}} </p>
      <label for="yearly_plan">
        <input id="yearly_plan" type="radio" name="duration" value="yearly">
        <span type="button" id="select_but" class="enlarge_on_hover">select</span>
       </label>
      <p id="all_perks">Conatains all <a href="">perks</a> of {{standard_plan.plan_name}} membership</p>
     </div>
    {% endif %}
    </div>


<div class="classes">
  <p >Select classes</p>
  <p>*You can only select 1 class</p>
  <div class="kkk">
    {% for name in classes %}
  <label>
    <input id="class1" type="radio" name="clas" value="{{name.id}}">
    <div  id="class_but" class="enlarge_on_hover">{{name.class_name}}</div>
   </label>
{% endfor %}

  </div>
</div>

    <div class="row buttom_nav">
     <div class="col-5">
       <a href=""><button id="exit">exit</button></a>
     </div>
   <div class="col-2"></div>
   <div class="col-5">
     <a href="{% url 'personaldetails_view' %}"><button id="next">next</button></a>
   </div>

 </div>
 </div>




 <!-- <script>
  // Function to load content of #mk without reloading the page
  function refreshContent() {
    $("#mk").load(location.href + " #mk > *"); // Load only the content inside #mk
  }

  // Refresh content every 500 milliseconds
  setInterval(refreshContent, 500);

  // Ensure that the content is initially loaded when the document is ready
  $(document).ready(function() {
    // Initial load
    refreshContent();
  });
</script> -->




<script>
// document.querySelectorAll('input[name="duration"]').forEach(input => {
//   input.addEventListener('change', function () {
//     if (this.checked) { // Ensure this input is the one selected
//       localStorage.setItem('planDuration', this.value); // Save to localStorage
//       console.log("Saved plan duration:", this.value); // Debugging message
//     }
//   });
// });

// // Store the selected class and its value
// document.querySelectorAll('input[name="clas"]').forEach(input => {
//     input.addEventListener('change', function () {
//         localStorage.setItem('selectedClass', this.value);  // Save selected class to local storage
//     });
// });



// Duration for 3 hours in milliseconds
// const DURATION_3_HOURS = 3 * 60 * 60 * 1000;
const DURATION_3_HOURS = 3 * 60 * 1000; //3 mins
// const DURATION_3_MINUTES = 3 * 60 * 1000;

// Save duration selection with expiration
document.querySelectorAll('input[name="duration"]').forEach(input => {
  input.addEventListener('change', function () {
    if (this.checked) {
      const now = Date.now();
      const item = {
        value: this.value,
        expiry: now + DURATION_3_HOURS,
      };
      localStorage.setItem('planDuration', JSON.stringify(item));
      console.log("Saved plan duration with expiry:", item);
    }
  });
});

// Save class selection with expiration
document.querySelectorAll('input[name="clas"]').forEach(input => {
  input.addEventListener('change', function () {
    const now = Date.now();
    const item = {
      value: this.value,
      expiry: now + DURATION_3_HOURS,
    };
    localStorage.setItem('selectedClass', JSON.stringify(item));
    console.log("Saved selected class with expiry:", item);
  });
});



  // Retrieve the saved selection on page load and set the radio as checked
  document.addEventListener("DOMContentLoaded", function () {
    const savedDuration = localStorage.getItem('planDuration');
    if (savedDuration) {
      const savedInput = document.querySelector(`input[name="duration"][value="${savedDuration}"]`);
      if (savedInput) {
        savedInput.checked = true;
      }
    }
  });

  document.addEventListener("DOMContentLoaded", function () {
    const savedClass = localStorage.getItem('selectedClass');
    if (savedClass) {
      const savedInput = document.querySelector(`input[name="clas"][value="${savedClass}"]`);
      if (savedInput) {
        savedInput.checked = true;
      }
    }
  });
</script>

 <script>
  function getCookie(name) {
    const value = "; " + document.cookie;
    const parts = value.split("; " + name + "=");
    if (parts.length === 2) return parts.pop().split(";").shift();
    return null;
}
  // Retrieve the saved data
  const selectedplan = getCookie('selectedplan');

  document.getElementById('selectedplanDisplay').innerHTML = selectedplan ? selectedplan : 'Not selected';
</script>

<script src="{% static 'temporary_storage.js' %}"></script>





  {% endblock %}

